---
title:      《System Performance》笔记，chap1，case study
layout:     post
category:   blog
tags:       [tomcat, translation, java, "System Performance"]
---


# case 1: slow disks

## 现象

dba通报有些sql的执行时间超过1s，以往并不常见，但在过去的一周内却达到了每小时有几十条慢sql，同时硬盘很忙，使用率达到80%，但其他硬件使用情况（如CPU使用率）却并不高。从历史数据看，过去一周中，硬盘和CPU的使用率一直比较稳定。

## 处理过程

Scott（故事的主人公，系统管理员）的处理过程如下：

1. 检查磁盘错误数量，数值为0；
2. 使用iostat检查读写IO情况，以1分钟为间隔来看的话，磁盘使用率为80%，而以1s为间隔来看的话，常常会得到100%，造成吞吐量饱和，增加了磁盘IO的延迟；
3. 为了证明造成磁盘使用率高不是由于执行sql查询语句引起的，使用基于动态追踪的脚本来记录执行时间和栈引用记录；
4. 步骤3的结果显示，数据库通常会被阻塞在对文件系统的读操作上，即执行查询语句上，事件长达数毫秒，从而证明性能问题是由于磁盘使用率太高造成的；
5. 排查磁盘使用率太高的原因，

# case 2: software change